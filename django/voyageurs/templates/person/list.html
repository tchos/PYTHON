{% extends "base.html" %}
{% load static %}
{% block title %}Liste des agents voyageurs{% endblock %}

{% block css %}
    <link rel="stylesheet" href="{% static 'css/datatables.min.css' %}"/>
{% endblock %}

{% block content %}
    <div class="container-fluid m-4">
        <div class="row me-4">
            <div class="col-10">
                <h4><i class="fa-solid fa-list-check"></i>  Liste des agents voyageurs</h4>
            </div>
            <div class="col-2">
                <a href="{% url 'persons:add' %}" class="btn btn-sm btn-outline-primary fw-bolder float-end">SAISIR UN VOYAGEUR</a>
            </div>
            <div class="float-end">
                <span class="badge bg-dark text-white fw-bolder">TOTAL DES SAISIES: {{ total }}</span>
                <span class="badge bg-primary text-white fw-bolder">COMPTEUR TOTAL: {{ saisies_total }}</span>
                <span class="badge bg-success text-white fw-bolder">COMPTEUR DU JOUR: {{ saisies_jour }}</span>
            </div>
        </div>
        <hr class="mb-5">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                {% include "include/alert.html" %}
            </div>
        </div>
        <div class="row mt-5 me-4">
            <table id="persons" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th class="text-center">N°</th>
                        <th class="text-center">NOM</th>
                        <th class="text-center">NAISSANCE</th>
                        <th class="text-center">FRONTIERE</th>
                        <th class="text-center">E/S</th>
                        <th class="text-center">PROV./DEST.</th>
                        <th class="text-center">DATE E/S</th>
                        <th class="text-center">ACTION</th>
                    </tr>
                </thead>
                <tbody>
                    {% for person in persons %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ person.nom }}</td>
                            <td class="text-center">{{ person.date_naissance|date:"SHORT_DATE_FORMAT" }}</td>
                            <td class="text-center">
                                {% if person.frontiere == 1 %}
                                    AEROPORT DE NSIMALEN
                                {% elif person.frontiere == 2 %}
                                    AEROPORT DE DOUALA
                                {% elif person.frontiere == 3 %}
                                    AEROPORT DE GAROUA ET BANKI
                                {% elif person.frontiere == 4 %}
                                    FRONTIERE DE ELOK
                                {% elif person.frontiere == 5 %}
                                    FRONTIERE DE IDENAU
                                {% elif person.frontiere == 6 %}
                                    FRONTIERE DE ABANG MINKO
                                {% elif person.frontiere == 7 %}
                                    FRONTIERE DE KYE OSSI
                                {% else %}
                                    DONNEES CNPS
                                {% endif %}
                            </td>
                            <td class="text-center">{% if person.mouvement == 1 %}ENTREE{% else %}SORTIE{% endif %}</td>
                            <td>{{ person.provenance_destination }}</td>
                            <td class="text-center">{{ person.date_mouvement|date:"SHORT_DATE_FORMAT" }}</td>
                            <td class="text-center">
                                <a title="Modifier les informations sur {{ person.nom }}" href="{% url "persons:edit" person.pk %}">
                                    <i class="fas fa-edit text-success"></i><span class="ms-4"></span>
                                </a>
                                <a title="Supprimer les informations sur {{ person.nom }}" href="#">
                                    <i class="fas fa-delete-left text-success"></i><span class="ms-4"></span>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th class="text-center">N°</th>
                        <th class="text-center">NOM</th>
                        <th class="text-center">NAISSANCE</th>
                        <th class="text-center">FRONTIERE</th>
                        <th class="text-center">E/S</th>
                        <th class="text-center">PROV./DEST.</th>
                        <th class="text-center">DATE E/S</th>
                        <th class="text-center">ACTION</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script src="{% static 'js/datatables.min.js' %}"></script>
    <script>
        $(document).ready(function(){
            new DataTable('#persons');
        });
    </script>
{% endblock %}